<!DOCTYPE html>
<html lang="pt-br">

<%- include('partials/admin-site/head') %>

    <body style="overflow-y: hidden;">
        <div class="row d-flex flex-row">

            <div class="col-2 px-0">
                <%- include('partials/admin-site/sidebar') %>
            </div>


            <div class="col-10 px-0">
                <header class="py-3 mb-4 border-bottom">
                    <div class="container d-flex flex-wrap justify-content-center">
                        <a href="/"
                            class="d-flex align-items-center mb-3 mb-lg-0 me-lg-auto link-body-emphasis text-decoration-none">
                            <span class="fs-4">
                                <%= activePage==='user' ? 'Listagem Usuário' : '' %>
                                    <%= activePage==='card' ? 'Listagem Cartão' : '' %>
                                        <%= activePage==='driver' ? 'Listagem Motorista' : '' %>
                                            <%= activePage==='func' ? 'Listagem Funcionário' : '' %>
                                                <%= activePage==='route' ? 'Listagem Linha' : '' %>
                                                    <%= activePage==='bus' ? 'Listagem Ônibus' : '' %>
                            </span>
                        </a>

                        <div class="dropdownw me-4">
                            <a href="#"
                                class="d-flex align-items-center col-lg-4 mb-2 mb-lg-0 link-body-emphasis text-decoration-none dropdown-toggle"
                                data-bs-toggle="dropdown" aria-expanded="false">
                                <img src="/images/admin-site/teste.jpg" class="bi me-2 rounded-5" width="50"
                                    height="50"></img>
                            </a>
                            <ul class="dropdown-menu text-small shadow">
                                <li><a class="dropdown-item active" href="#" aria-current="page">Sair</a></li>
                            </ul>
                        </div>
                    </div>
                </header>

                <div class="container ">
                    <div id="alertContainer" class="mt-3 position-relative"></div>
                    <div class="row mb-5">
                        <div class="col-12">
                            <% if (activePage==='card' ) { %>
                                <form id="cardForm" method="POST" enctype="multipart/form-data">
                                    <div class="input-group">
                                      <span class="input-group-text" for="saldo">Saldo</span>
                                      <input type="number" id="saldo" class="form-control" required placeholder="">
                                    </div>
                                    <hr>
                                    <div class="input-group mb-3">
                                      <label class="input-group-text" for="inputGroupSelect01">Tipo de Cartão</label>
                                      <select class="form-select" id="tipoCartao" required class="form-control">
                                        <option value="4" >Escolher...</option>
                                        <option value="1">Comum</option>
                                        <option value="2">Estudante</option>
                                        <option value="3">Idoso</option>
                                      </select>
                                    </div>
                                    <hr>
                                    <input type="submit" value="Cadastrar" class="btn btn-primary" id="submitBtn">
                                  </form>
                                  

                                <% } %>

                                <% if (activePage==='user' ) { %>
                                    <form id="userForm" method="POST" enctype="multipart/form-data">
                                        <div class="row">

                                            <div class="col">
                                                <label for="foto">Foto:</label>
                                                <div id="preview-container">
                                                    <img id="fotoPreview" src="#" alt="Pré-view"
                                                        style="display:block; width: 100px; background-color: rgb(170, 170, 170); height: 100px; object-fit: cover; margin-top: 5px; margin-bottom: 5px;">
                                                </div>
                                                <input type="file" id="foto" name="foto" class="form-control">


                                            </div>
                                            <div class="col">

                                                <div style="margin-top: 105px;">
                                                    <label for="nome">*Nome:</label>
                                                    <input type="text" id="nome" name="nome" class="form-control"
                                                        placeholder="Nome" required>

                                                </div>
                                            </div>
                                        </div>
                                        <br>
                                        <hr>

                                        <div class="row">
                                            <div class="col">
                                                <!-- Campo para Data de Nascimento -->
                                                <label for="nascimento">*Data de Nascimento:</label>
                                                <input type="date" id="nascimento" name="nascimento"
                                                    class="form-control" required>
                                            </div>

                                            <div class="col">
                                                <label for="cpf">*CPF:</label>
                                                <input type="text" id="cpf" name="cpf" class="form-control"
                                                    placeholder="CPF" maxlength="11" pattern="\d{11}"
                                                    title="Digite apenas números, 11 dígitos." required>
                                            </div>

                                        </div>
                                        <br>
                                        <hr>

                                        <div class="row">
                                            <div class="col">
                                                <!-- Campo para E-mail -->
                                                <label for="email">*E-mail:</label>
                                                <input type="email" id="email" name="email" class="form-control"
                                                    placeholder="E-mail" required>
                                            </div>

                                            <div class="col">
                                                <!-- Campo para Senha -->
                                                <label for="senha">*Senha:</label>
                                                <input type="password" id="senha" name="senha" class="form-control"
                                                    placeholder="Senha" required>
                                            </div>
                                        </div>
                                        <hr>

                                        <!-- Botão de Enviar -->
                                        <input type="submit" value="Cadastrar Usuário" class="btn btn-primary">
                                    </form>
                                    <% } %>

                                            <% if (activePage==='funcionario' ) { %>
                                                <form>
                                                    <!-- Formulário de Cadastro de Funcionário -->
                                                    <input type="text" class="form-control"
                                                        placeholder="Nome do Funcionário">
                                                    <hr>
                                                    <input type="text" class="form-control" placeholder="Cargo">
                                                    <hr>
                                                    <input type="submit" value="Cadastrar Funcionário"
                                                        class="btn btn-primary">
                                                </form>
                                                <% } %>

                                                    <% if (activePage==='motorista' ) { %>
                                                        <form>
                                                            <!-- Formulário de Cadastro de Motorista -->
                                                            <input type="text" class="form-control"
                                                                placeholder="Nome do Motorista">
                                                            <hr>
                                                            <input type="text" class="form-control"
                                                                placeholder="Número da CNH">
                                                            <hr>
                                                            <input type="submit" value="Cadastrar Motorista"
                                                                class="btn btn-primary">
                                                        </form>
                                                        <% } %>

                                                            <% if (activePage==='linha' ) { %>
                                                                <form>
                                                                    <!-- Formulário de Cadastro de Linha -->
                                                                    <input type="text" class="form-control"
                                                                        placeholder="Número da Linha">
                                                                    <hr>
                                                                    <input type="text" class="form-control"
                                                                        placeholder="Descrição da Linha">
                                                                    <hr>
                                                                    <input type="submit" value="Cadastrar Linha"
                                                                        class="btn btn-primary">
                                                                </form>
                                                                <% } %>

                                                                    <% if (activePage==='onibus' ) { %>
                                                                        <form>
                                                                            <!-- Formulário de Cadastro de Ônibus -->
                                                                            <input type="text" class="form-control"
                                                                                placeholder="Número do Ônibus">
                                                                            <hr>
                                                                            <input type="text" class="form-control"
                                                                                placeholder="Modelo">
                                                                            <hr>
                                                                            <input type="submit"
                                                                                value="Cadastrar Ônibus"
                                                                                class="btn btn-primary">
                                                                        </form>
                                                                        <% } %>



                        </div>

                    </div>
                </div>





            </div>

        </div>
        </div>
      
<div id="alertContainer" class="container mt-3"></div>
<script>
  // elementos formulário
  const userForm = document.getElementById('userForm');
  const alertContainer = document.getElementById('alertContainer');

  // exibir alertas de sucesso ou erro
  function showAlert(message, type) {
    const alertDiv = document.createElement('div');
    alertDiv.classList.add('alert', `alert-${type}`, 'alert-dismissible', 'fade', 'show');
    alertDiv.setAttribute('role', 'alert');
    alertDiv.innerHTML = `
      ${message}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    `;
    alertContainer.appendChild(alertDiv);
    setTimeout(() => {
      alertDiv.classList.remove('show');
      setTimeout(() => {
        alertDiv.remove();
      }, 500);
    }, 5000);
  }

  userForm.addEventListener('submit', async (event) => {
    event.preventDefault();

    const formData = new FormData(userForm);
   
    try {
      const response = await fetch('http://localhost:3000/api/user', {
        method: 'POST',
        body: formData,
      });

      if (response.ok) {
        const result = await response.json();
        showAlert(result.mensagem, 'success'); // Alerta de sucesso
      } else {
        const error = await response.json();
        showAlert(`Erro: ${error.mensagem}`, 'danger'); // Alerta de erro
      }
    } catch (error) {
      showAlert("Erro ao enviar os dados para a API.", 'danger');
      console.error(error);
    }
  });
</script>



        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
            crossorigin="anonymous"></script>
        <script src="https://kit.fontawesome.com/66b39b2469.js" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    </body>

</html>